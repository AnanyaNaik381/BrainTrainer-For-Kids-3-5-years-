<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Neural Pulse: Master Recognition Edition</title>
    <style>
        body { background: #05050a; color: white; font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; overflow: hidden; }
        canvas { background: #0a0a1a; border: 4px solid #00ffc8; border-radius: 20px; box-shadow: 0 0 50px rgba(0, 255, 200, 0.3); cursor: pointer; }
        .hud { position: absolute; top: 20px; font-weight: bold; font-size: 28px; color: #00ffc8; text-shadow: 0 0 10px #00ffc8; }
    </style>
</head>
<body>

    <div class="hud">LVL: <span id="level">1</span> | SCORE: <span id="score">0</span></div>
    <canvas id="gameCanvas" width="800" height="600"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        let state = "MENU", level = 1, score = 0;
        let sequence = [], userStep = 0, flashIndex = 0;
        let puzzle = { q: "", a: "", options: [] };
        let timer = 100, penaltyMode = false;
        const memoryIcons = ["ðŸŽ", "ðŸš€", "ðŸ’Ž", "ðŸ‘»", "ðŸ”¥", "ðŸŒˆ", "â­", "ðŸ¦", "ðŸŽ¨", "ðŸ•"];

        function initPuzzle() {
            state = "PUZZLE";
            timer = 100;
            
            const categories = [
                // MATH
                { q: "1 + 2 = ?", a: "3", o: ["2", "3", "4"] },
                { q: "4 - 1 = ?", a: "3", o: ["3", "5", "2"] },
                // COLORS
                { q: "Find the RED heart", a: "â¤ï¸", o: ["ðŸ’™", "ðŸ’›", "â¤ï¸"] },
                { q: "Find the GREEN square", a: "ðŸŸ©", o: ["ðŸŸ©", "ðŸŸ§", "ðŸŸ¦"] },
                // ANIMALS & BIRDS
                { q: "Which one is a BIRD?", a: "ðŸ¦œ", o: ["ðŸ¦", "ðŸ¦œ", "ðŸ˜"] },
                { q: "Which one is a CAT?", a: "ðŸ±", o: ["ðŸ±", "ðŸ·", "ðŸ¸"] },
                { q: "Find the OWL", a: "ðŸ¦‰", o: ["ðŸ¦‰", "ðŸ”", "ðŸ§"] },
                // PROFESSIONS
                { q: "Who puts out fires?", a: "ðŸ‘¨â€ðŸš’", o: ["ðŸ‘¨â€ðŸ³", "ðŸ‘¨â€ðŸš’", "ðŸ‘¨â€ðŸŽ¨"] },
                { q: "Who flies the plane?", a: "ðŸ‘¨â€âœˆï¸", o: ["ðŸ‘¨â€âœˆï¸", "ðŸ•µï¸", "ðŸ‘·"] },
                { q: "Find the DOCTOR", a: "ðŸ‘©â€âš•ï¸", o: ["ðŸ‘©â€ðŸŒ¾", "ðŸ‘©â€ðŸŽ¤", "ðŸ‘©â€âš•ï¸"] }
            ];

            let p = categories[Math.floor(Math.random() * categories.length)];
            puzzle = { q: p.q, a: p.a, options: p.o.sort(() => Math.random() - 0.5) };
        }

        function initMemory() {
            state = "MEMORIZING";
            sequence = [];
            let count = 2 + Math.floor(level / 3);
            for(let i=0; i<count; i++) {
                sequence.push({ 
                    x: Math.random() * 600 + 100, 
                    y: Math.random() * 300 + 150, 
                    icon: memoryIcons[Math.floor(Math.random() * memoryIcons.length)] 
                });
            }
            flashIndex = 0;
            animate();
        }

        function animate() {
            if (flashIndex < sequence.length) {
                setTimeout(() => { flashIndex++; animate(); }, penaltyMode ? 400 : 900);
            } else { state = "PLAYING"; userStep = 0; }
        }

        canvas.addEventListener('mousedown', (e) => {
            const r = canvas.getBoundingClientRect();
            const mx = e.clientX - r.left, my = e.clientY - r.top;

            if (state === "MENU" || state === "GAMEOVER") {
                level = 1; score = 0; initPuzzle();
            } else if (state === "PUZZLE") {
                puzzle.options.forEach((opt, i) => {
                    const x = 180 + (i * 160);
                    if (mx > x && mx < x + 130 && my > 350 && my < 430) {
                        penaltyMode = (opt !== puzzle.a);
                        if (!penaltyMode) score += Math.floor(timer);
                        initMemory();
                    }
                });
            } else if (state === "PLAYING") {
                const s = sequence[userStep];
                if (mx > s.x-60 && mx < s.x+60 && my > s.y-60 && my < s.y+60) {
                    userStep++; 
                    score += 100;
                    if (userStep === sequence.length) { level++; initPuzzle(); }
                } else { state = "GAMEOVER"; }
            }
            document.getElementById('level').innerText = level;
            document.getElementById('score').innerText = score;
        });

        function draw() {
            ctx.clearRect(0, 0, 800, 600);
            ctx.textAlign = "center";
            
            if (state === "MENU") {
                ctx.fillStyle = "#00ffc8"; ctx.font = "bold 60px Arial";
                ctx.fillText("NEURAL PULSE", 400, 300);
                ctx.font = "24px Arial"; ctx.fillText("Learning & Recognition Game", 400, 350);

            } else if (state === "PUZZLE") {
                ctx.fillStyle = "#111"; ctx.fillRect(200, 80, 400, 15);
                ctx.fillStyle = timer > 30 ? "#00ffc8" : "red"; ctx.fillRect(200, 80, 4 * timer, 15);
                
                ctx.fillStyle = "white"; ctx.font = "38px Arial";
                ctx.fillText(puzzle.q, 400, 220);
                
                puzzle.options.forEach((opt, i) => {
                    const x = 180 + (i * 160);
                    ctx.strokeStyle = "#00ffc8"; ctx.strokeRect(x, 350, 130, 80);
                    ctx.font = "50px Arial"; ctx.fillText(opt, x + 65, 410);
                });
                timer -= 0.15; if (timer <= 0) { penaltyMode = true; initMemory(); }

            } else if (state === "MEMORIZING") {
                ctx.fillStyle = "#00ffc8"; ctx.font = "24px Arial"; ctx.fillText("MEMORIZE THE SPOTS", 400, 50);
                if (flashIndex < sequence.length) {
                    ctx.font = "110px Arial"; 
                    ctx.fillText(sequence[flashIndex].icon, sequence[flashIndex].x, sequence[flashIndex].y);
                }

            } else if (state === "PLAYING") {
                ctx.fillStyle = "white"; ctx.font = "24px Arial"; ctx.fillText("WHERE WERE THEY?", 400, 50);
                sequence.forEach((s, i) => {
                    ctx.strokeStyle = i < userStep ? "#00ffc8" : "#222";
                    ctx.strokeRect(s.x-55, s.y-55, 110, 110);
                });

            } else if (state === "GAMEOVER") {
                ctx.fillStyle = "red"; ctx.font = "60px Arial"; ctx.fillText("STREAK ENDED", 400, 300);
                ctx.fillStyle = "white"; ctx.font = "20px Arial"; ctx.fillText("Final Score: " + score + " | Click to Restart", 400, 360);
            }
            requestAnimationFrame(draw);
        }
        draw();
    </script>
</body>
</html>
